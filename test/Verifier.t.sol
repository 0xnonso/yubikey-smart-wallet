// SPDX-License-Identifier: MIT
pragma solidity ^0.8.13;

import {Test, console} from "forge-std/Test.sol";
import {Verifier} from "../contracts/verifier/Verifier.sol";
import {Utils} from "./Utils.sol";
import {
    SignatureProofInputs,
    AttestationProofInputs
} from "../contracts/libraries/StructInputs.sol";

contract VerifierTest is Test {
    Verifier internal verifier;

    function setUp() public {
        bytes32[] memory rootCertPubKeyModulusLimbs = new bytes32[](18);
        Utils.packPubKeyModulus(rootCertPubKeyModulusLimbs);
        verifier = new Verifier(rootCertPubKeyModulusLimbs);
    }

    function test_verifyAttestation1() public {
        bytes memory proof = hex'1531eb541cfb86609b92f02283d07f6b00f57a2c0cde59ce621670bc5a17c86325bf90e8ac9f979cee3aefadd680e5247defcc126da4468ec314f5a632e188ae090d8ee051275bef9810bfd1245c78d470df2fde7651a94bed8e4977ce8f8de1262c569e4897c56ccc3d06722fb49cf2866a6e8811dc446fa3734be9d3172e7229af8515189f83ee923dea16001705855945765e515c03d5acbe9e3550961e1f072f3f3c76d56facba3dce7cd68c1101aa9e8187152a7922d61b04d1ee5108872e64a8b6ba26cefe57437ce614f901eb3e7a58625fe74a170d8e47e4f80b523125352474d80fd75b87885042e280a7b97e7d342e2b81e30b433396a927320b050979cf1b92729c5ba1bdc5f8f7efbd21662e44062a8c65ec13c87050d6d1630013c28f1f388aad4895ea46d091278e40fb694a2eec937bb6def03f8cc9ea38f829dedf8a0454b78b036deb7f4e7c0cbe2412676b6f0d9e0c38a95fe2623ec7f802a99fbaac7db5557fbe997468a17f5efcd05f4e4c9e25b216a4deb5ecb47d1423b1cdaf0a608c7d127b521eb24ba083c1f259c78fd8d0c97fbc65ee584edc7a0fd8c7bcf2fe59de86107bbd78fc41bf8db274c20153ab13623c359d9d8121ce26e62d87b0f4c2ce840a47eb645afaa0404a2ba439b088b9a86c16bdad9761a2112af276a68198ace3e3f0feeee9ab88e2be07a6975715c23ded0637d093f0ac17daf170f9ff82c11bcc72f7b9ffe83f23b3c2a3e8173bee9c07fc7af9a304891989cd0829e486a227d823155c6bf95aa5fe0905add6ddfe526de1cb5332a74525f1c311ceb7f2e6c7103400088cb7d95617d92caa84d735581620da328dc5d60180356438f1b49822393afb557afdd62163b5ef3df62379a094b7bae8f9927a01c9f73fb689f46bdba03d2c75def6e675ad421c882976519d114e8821709f5e03937927c582fa66fc20b29c210b504399a87a3089fe27f7e6b6794a66293586172495f11bafe5b19cf6c9c4bb7309fec06f1ef00b003d74eefb23c60882f64f0c937d080107b0b24a82a8f36b669957b23e4babf37d386b80ca456bb724188a1dee19b5a8213727d242bbce1505c32155f3168dd857c9faff8ff01871f76b0e0ffa23ae0dbdfbdf694a64d9b66a4c896152421165a46c49b90d98f6b3b2365c005c668f6da910071dc964e6341a14df2ed7e04468e78bdcd631ae35ee3cd44c269c31075126f966a38c4d02421541f5615dad438946875c303a8575113b46532803696af5cca487a94e1f39248df6db756bb392f94e07e1265a6a83fb44a69d1a571f2541b8cc687e5be14444733a17529568e228eac50175d9a9148c903ab3119102221640f8a556ea8f05c578b2dc3c3bcb67395c11371d4d5899bab3ed301c25383927c890745b1bd14c7919ce95fbe6b1b958e24361f20b4cb5c3710c3d2d35fb89b7f3c174d5a108a157814b7a5047fe6c2934d0efb127731c82f57a260e5faba0dbc89b37af99d22e423c3081ff01ab4292291f043ac9e94cec3d91621b86f5822d6c1468143171a21e4483806c42f9a27855c15d06e23fd509dbe48710ac23967d10d5a312482ab7be21da031bc61f476bc464afc6708fff2fe0e8390be3bfc6e6cc19a9c99da2222c0b5889f93e7342cbe5f326d02c3c0f7365dfad18a0a429fde5bb0d48917739132de34cc9b3baceb2808316496b4951543509670251edac452cba1abe69716ec8ba06fd1fabcad483a5beb076af960f247754211edac558b2ad35b1d2b9e91f3987f51053daf8f4c6e83f1122a243b0b5a4cd2100f381a216361cc3f8a303fc939fe85775d2e425da6ae26be39221ffefdd918f07060e636dce930b622878065f50798e6b3aead380668ec2dd5dc7f32b5a47250ad0afcdf682eefaa67a20310d708b27b562d3d7efc4f0db2062704ae4627fdf0916f7214a84fe0fb03e0d2d8b83fc31794e86844ee6ecaa56606c7226f02f1d15c40523fe1e6a50e19f4c09e4a7ef57d91505f1c69e96429ed2b5f0b274b7030977d9dca8c9ff7fe9f7161871027d5f661497726a5cb6539c7edcc7d76be05c0211fb1cc175523113cc029efeb9b0531041f8588f863a837486e62e652f6d9817a1db16bd2adbad7e708009cb2a6da02c8801558aac6cff5055a604aced92ee026d78ecb920662dd547869e0d4190f07a469263fb2060a883bfd1393cd361e814c3c676142c3b1417618fbddeb78f66ebcb092d20eb96f89c2f569ddab2218709941492960440bee768a413b13b0f6579aa876c6bc2a40e81678b8b0582118116b0423f9b9b6a233ea2f423dd522f4c2cb605419bcf28ed540319633f0ad1fc1f0666091ee1d9c8e9fb68c2bc3c64bad4f7b76f7d478b23c515a6ef065e88a50f05da46a5046edd12c187959754362bab093f31b60c65bc0bfe67b269af17dc13146171ce0ff29eac3914340a16c495cd523820eaa5a60da00b29cf5eab7bed0d768bc98f80ef52a65bec05312df202b3d6847c7b866cb2796de583867bcb190cf472b773737afda12314b81a62e200b59ecd57a5e6ca7742559b98daafee34039b806e793f236ff5c145bb71e8a771477b23a6214ba49a819770c26c7ee55c0eea613b045b5b83c662870474f8c0f8ba200704de5a925aea73743c2f657af12fee9a0342d17c6877e0801de08484af463600e61fa47e93cf542dc12bc15e982fed8bb0a430ce46dce524b2ac23cec071971777080f162b7aa74afb3d96e58a1c88a9dcb01d167dd292633d6831e710dfe2e007895ed6ec8d81346fed8ce76c09087d5b441afbd9ab596780894910eae4989c1f7409d3b8cdacdd929abe3f8c0fe6773a9fd26020572ae1ef8a333559cba919ffbfbaad07c814693b40a746ba0889d6e31f9838bd08f462dff45e04924700f182c049e6cdcc11a6d1e3308b681831fadf3033357c8a5f3b27f86bf53b13e3a4efb53bd402aa62deb13234c00c20d372627c59be218c88a2569a9b3ec3c6c6397257603a5e82777c45e799f75e';
        AttestationProofInputs memory _inputs;
        _inputs.pubKeyHash = 0xd45c67436abf1348c998f4065086971efcf5dd08c52cd0ae95f02f42afb77534;
        _inputs.proof = proof;
        verifier.verifyRSA2048Attestation(_inputs);
    }

    function test_verifyRSA2048Signature1() public {
        bytes memory proof = hex'28b1ad47aa006d3bf6cb2e19503d7949aafee0421fdb8bf795a6fc430d52716c10935c987e8c610580007127651292f222a169eaea0c3d3024b157a68a743bfa21a1267f5cdf75d436af5dc764abc0b273d8a3126de2693361bf6fd21c41c4722ab01ff2ceb5b4bd0e7ba5703dce3207aacf3a3074522bb4723b7ca321019e7f0ddb119b7e6611c958dc336ad6bcd0f2e01b76dfc2c5f061558480cab0afd5560df60332b1d4fc6277b2671f79e2f8a76bbeaef155b446c45618b1e55e886cb72fe7808db30442e87d422367b6ae92c2292c8888e2a1d85103acfd651f4771c4126272c4d209f6c91700f0e4447c2c282b8ac961dac0056c46154c325cc3fbe2250807dc4cba323fc4814fa6e449cf8fb6c55587501c52bbcfbe4cc01c1395af00d983bd4e280422b1af4f2c85f74e5d72393c7b319b03d6a7a69695a735d310147461b4195700e5cc7ca8036299437ef8b5b35625b6f13f307a6da6ab37d52a2e769a74c4313839ee1f9d9553acc4e1dd7a6c1237449473d7ff5f794fc2ac830196f545ddd5c2a2ebf66a7782ee477a17637e21f80a99a3a48d2befbc3213c915714b6180e5f872b13034e04509f238e117390e3843cc1138281303eade1154297ce2aaa56420208eea0b9f8b90b3d450510d9fd2db84a9b6544c782719d302032c5fb57523822bbf321627d18b43c564e2bfe98dbfb36cd79eecd04f9da7340eef3aea5e2a2bf6fcb90993bc3454530e77f5c30c88cf2a910d5e21e6a0f4bf1adc2831097125fd4fc9277e58d3e8ec4bf257af7b010e5b7597791e02f0d4ca143d224f02bee8dc50dbe1dd0f2459ccc4b1c6bbc550863bc011c713ad41b4c32258d3946d1275ba16c9fc09d4ccfdc1cc4869051a00381e0123e1cddcaf86e52a48620c2bcfedb7161975261f035b5edcffd12e26a75801ab5db260766dfb8d2201d29db11b54fa04bd9e0ae88d348f753f988c3ca9f3a5d12c8d99105843e108ad4bce0e601d8efc065d7c8f3655f73d4f6b8bf05331c826a5fb206af7d68114651022f1dcd1a1d1760db4a15c2ad622616d5dd29a2f9cb7cf2c7cc8f614b00ae3e95d152cb9943df40ab1924fcd32d11ee737e790fea5f233b1d36ccb077e18fd09a94de73af9ad745d963d935c7242a62169646aa4882148b0dfff7ef690003f300922200d33625f4e2aaae582b7ca11c776c3133e7d875e426b5f82e5441494704f9bd1a8e6e368972ad9a010d4adaa35621c85fc47948a5eb61ffb001d188a862850f5533ae8f3746ba69d87e4d403b1cba2191ec54e757ca04bb1b6bf1b071e9698c4670e49271870cb09ea3a4e09456d44e01f44e68a0d3c16b035002d72a5eb65962f07c84d8108a780d94943f01ddc54019b2f1eb954fa01dc987201c2ad97bb4f4e4b84a08aa5030880ddd8350060fcaf423c0bc29f39c3e5cc7b15e088e7a6bf52251750f4a10454225a515988d8f74716f4c74dee8cfa6279461afb296c20ea0e3617109a1236ab6d7e2c86f9cfaedbca618e48090e566de2980474a51f60b3a1b296d8df8e76988d42796c316fa55c19234f9e600d3ce3a2cf00f392b07bc798b9625038d9f3cdacd7f4c81b126c97526d6497c7c0f0a81c3e13963151b1fea33b52b35f1058e54feaae5e5fbf27911fe32b07c684e51290f224fd450cbbabcfbf4227e198aef01c85877a27cacfbcd5a74f26222e5a8043991e58742d82093504208c4081175fd32a54b5150a211a62999e310bd9bd7212381c60e3953bfdd40e9d3c5cd082d74f5865f0721d00b5b658030a3570b6f42dfa170880441ea6c5e4340140603f9aba6145b2730bb642339d24cba98352df15f415fff5e7507cfeda322a513536232ac76f71aee154b1e799ca39dec224c276de2b8218b47f0e181c782ca02c7217691ce4e0045c171148d0c042b22fdbe9961127194bb291fd4964df0e313e4f9b88e75890d8ffcdc1c895cda34184e01d0fdc18a25bbed9dfac4fffe24de5733231a7938d3477c4c8f5ffaf1744bf449d80d3248988f15ba569692873194cca77a225b9a781a01d8318db0473b20c8cda21d128867e8df19167029db82a3e257339f8c0fb126157545d84888abd8715f4fe4810eda7f67ba5bf02a8a37222357d8902acf00ff167eaccd966a683bd46430b2a263b14b992d9c3099743181949e476d9ecab411b544b506488f5213013ce55ec01ce83eaa9200477652993946c17f50059feea6f4dd8b846bdf7077aa687a7fd1f34c6d5c288db4fceb716c6149da58cfcd5c37509ebacb4d30b3760d7f390c224f8078b950f069b06b253982d38244093f98a2406b1e06e8649702c4b9bf5a20d59e5d854c7190cad75192460c6127010cf43b175c7971a016a834eeb738e3205b32d2303b6e3c6a9de93490872140d556f955ebf865a698248f7a4c12f173a094fdbd2f69256ee0f7e50c95553bbd0bc57f886d143a5d5ee376e0aa23f5c0819de2e74a3dcfacac819bdd3d25614f0bc1a4393a2f88fee2dde9619a4fe1c4e22b7b5ffa0b9cd0c44dfe9987c04f01d0866537f3eb5761257d52f4802d3d66d04fcabcc8ba289ccc056bbe46a5a87080cb9996632648a1429d8ec5207a43e591385a2c2c62a9c4a0b95fc2aa1dd56040bd43bc070f18d7c12f351bfb7875c472d1ba3b547a55cf685971581392d1df1125f3ba422d9136427709bcb454f724422fbd566fd030f1b7e35f13d14614c7b609d7871f49dc91d4d290c69121442fa2ecfd7f11fad77bfec2f05717f542529462d659720cabaa0280ca9dcf0a89edf19ca3ee5937eeb5646dc772cf580a18e723d9f9b99338111005aa3f04df46ade1bb886f72e2bf8916aafaa521dabaa95bc314f2ead084e2d81a8bc229e179c4a00c8cd8e1f367a884f285dc6af68fb39777ff7c46cf8d11a31d3ac924db336d8024550aacaa296c9f1116ca04e32d6bd74d6c717899ada2a6f2fba4268ffecb126c97f6cc240f87842322e0db8189837d6f6cc46fe4ead72cc6226334ecdeaf5';
        SignatureProofInputs memory _inputs;
        _inputs.pubKeyHash = 0xd45c67436abf1348c998f4065086971efcf5dd08c52cd0ae95f02f42afb77534;
        _inputs.messageHash = 0x653842f472a6851c2022725644f74899d39ad2a808c652e68d1593a1f1725459;
        _inputs.proof = proof;
        verifier.verifyRSA2048Signature(_inputs);
    }

    function test_verifyECP256Signature1() public {
        bytes memory proof = hex'2d0b6a871017521fd49771cc4a2b0290a6126ffd356543f4883f2728d094a0ab1dace5af06df677cb3d8ca998cbcc7b823932cd88c8cbb818cf70218df9e8c500544c36aeb18573b001d22873f51d6cb6f393f90d3152115e88681e9038efbca2814768af6e4c6a1184354addb7c846587bafcb60b0becd4f8ad940411b854ca13dc3f3fc2d0ed529df5961ac60341d4a257ec0244d5d93fec2a0c27122a0ccc0f99acfeec46cc1e7fce078edc411e2b2120fb6b03c4efecec0808adbd4a641e0a7b77dbbfdcd15c919d1f69b79e2a19ec18ba836ade9609c01820c65d42e46622becc7d0b0993a630bf33904b2de7d12492f3cde5b1889033a008321a61f78f139d8e3cef7c286aee702a88abe3a341581b7e97428a83d56d901a1c0e7cbdd51f31dafb71ee5de43de9193e0f6623f3d2129f193c69beb7212eeffd9d0112ca26320b418179ccf1592bbeb72a16155b3c3e80f373ae046a4996d9b28f86d8d00023f5e4fb1dc824b2beb266d4da5224cd86b31167d92322346fb774844f0419011028440e21379da365879c22e761c451cd795ecb5bdf871df3109f07c67381110d03e6b4188addebaec122cda0f658cfce31cf6c8f05740860ddbf4b1b7ebc2952c43ae2eb5cf7d3386716130c015105b4a2dc1b0cfa7369f426cb8c7856511ca55c34cce4b349a2f9894ded3be0020345958edbe91019f93bd66b537675321b8605b35906ded4a3c7d15a23deecf4865567c8603b43b0a037b6c2e4ef7da10ea4b0f75406600a1b5b3fef35c0898a4c64b050219178bf3fce19827f405493084f066144f26155f1941a4f3ce2c554c98422861cbf9c75310676441c56e8962da35506d7a53f685a75e4d822609e61cd8018e4e84a2b27885b89ce10551e5805c88d1cd52e100e845633a6d9925b024f9770178875488103e597fc4b13fcc004b8d7199dd2c4bd50cd00b151a31db927d5f5c69e5a26c8947d2fe7bf8702810a9dadce12d1d8c3e275b235a76737a261905492e2db478198bf0e84241c831c2dc78858e0c1e896239cd4e694dba09b5d5b758d7b45bc3106ab2b8c44bceee216720b36e5eae19f6c503cfea04705459bb5899f0b3a24d9da32df4e360efe95039ec11da5018dee5b7b5f3f2170e29c6ae8a519352729528cf4cb742a377d2416467e46cdd12c74b2e8cc770dbe63cf63c0dd4fbc8e05852f050a72bca5caeb1bc96620900ebf01bf5166273cb00356b19667ca6d8af9cf5a5db3f404ddfbd825a91549a4950602f8f1e9c37f7caf7fc0918cf6ff429132bcb22144560681cf03cde3ab2d8d9c8d5becdf7a51c018445b2972d6337337c9a0956ddbddff16c80c58e79d22b3b276234e7f902ee208a8644100fa98aa806bf6ffde16b50a583e1365c5e4d768c286aaac88f85a99befbad28cc7ce4f220a8a7390c8e2d56aa2c08ca90bfa539925e9209366369b8e78384278f458ea95cdcaa00f0f5e372771d1f8b1f0f9b501431819b6f36df4ecadb081b084b3747fdba5d72344278090dc91b35a1a69d93d9aa8873fe9b540a32ce29914357d5c4983f18275794ac04cfa3214826310330305fe04612c4cd2a25014233063cc6ce77fa687a68cc773d636c082bce0e8997bdf40815442cb02e73989895fa8ee92a476b64ff1577dbe96d4f1cbb3e473336d73a5706134603cfd2d9ffc2bc99090fd8ed8bd17eb918f913d7189cc4948193653f2237a1850fa7c1d98a04d568bbaaa28975d634d8087a8b3608539dd5a98b0ff6e5a1ca919008d9549d10b4f0d6aa1b3826c1810b373ff8fb1886a0aa02b5887ee9335c5f7d0f38f4f799df60e9447c073110a0129efd646813c8f112d852d2ce07ec76de711d23d6c20da3aa6d5f61bedbeffd3c81ffbfc321d746da09b44655d353795c295038190edbdd09eaefb9bc717f33ba8c65a1a514033d749efb68e468205478309dcd746fef015b98d5c6ac8bc5b910df258387169737f712db473096e2c3c27f7cdc12f5c42d78923dc1bfb6361068a176910808c0b29168cfd95f6928a139572b7d2a7caafaa25d2146f5217cdea6ab068a6524de0297317cd620039f7c98b6e82a57935626820970f0e88ab09f5446d94f3f0a5ee71fa71c5fc92b516833be65c5bbe11d970f789f0aeb889311f091b1d9ae2d18064a936ca24a9aa83d3cb4c3773a7821cf600c6e39b3735020455e7d019925cccce71e5185c9d89b3fea1748b2524dcbe085ce3408e86ecff86c0113c7bd0998dad1c692ebb144301711acc543e0f3f4fa597647694f2ad944fc8a595946077f8423f5832a641b7659fc77aa770c34d8c3cc1c586a1e8b91904303a237ed1d6563d0a799cdee382f672d22de2db960c798caf699c3370dc27287ed7f6bd925bc354a5d133f19ed9864890b184092cd159147e490f1393fb8a24cedaf2503032f254dddfd6ff2918059ebbf8eb191a87f5bf3b05be769f6485de0161b436b1afcd2ec90e7c2f8fc19e4951d409f2f1bfbfc0692731ed96e35edb9474164441e826d9c6e2ff186a20acbf9897e581dbe91c911607b0dd64f37036e16cabcc21ddeaa7d598fd2bba2fdec6621569a8ff7419c05d03b0d3c89bc2ceff21fbf2212bc38ac978477653a47462cf35982edb7b4989953121cb9679dc7a7abb365c920c11dd0e84e0e06b95f5028eb78a905be5d2597a22cbab975e5e8a98e234eda0a3973c37f7aa7a33b87ae2197c2b4f3d284c321f01dd06446bd8d9c0b9a313a24a8164531c6c1be970a8d915b39b78cdd4dac6ef377af58a538d76eb7e741811f5163f41e0425956744545dba92111e89d47e80a0df6255087dd31137d3316a1514b075ee26dca2c62f8dd87a10b62b785a87113dfafac60fc1b8a068017f06235d6e79e4fc039b64453f1e8e1377ba8d59e574c73924de5f4ae84a66739e99160baf9ca2eef562f8115686d99fc1482417ad07e59a3afd80ddc1718faad09f29e423119396b31f8f9ffe554d3e25b42d0601ccea8a78d5190015f921d2ecb5';
        SignatureProofInputs memory _inputs;
        _inputs.pubKeyHash = 0xa773500dcddcd8aa9d09dbf98eaff6c29ea53b360449f7db7a808ead7ffce84a;
        _inputs.messageHash = 0x653842f472a6851c2022725644f74899d39ad2a808c652e68d1593a1f1725459;
        _inputs.proof = proof;
        verifier.verifyECP256Signature(_inputs);
    }
}
